import socket
import sys

def usesocket( host, port, request ):
	# Create a TCP/IP socket
	sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sock.settimeout(5)
	# Connect the socket to the port where the server is listening
	server_address = (host, port)
	print >>sys.stderr, 'connecting to %s:%s\n' % server_address
	sock.connect(server_address)
	ssl_sock = socket.ssl(sock)
	
	try:
		print >>sys.stderr, '>>>Request\n\n' + request
		
		# Exemple of GET request : "GET / HTTP/1.0\r\n\r\n"
		ssl_sock.write(request)
		
		print >>sys.stderr, '>>>Response\n'
		while True:
			data = ssl_sock.read(8096)
			if data == "":
				break
				
			print >>sys.stderr, data
			
	finally:
		print >>sys.stderr, 'closing socket'
		sock.close()
	return
	
usesocket("vulnerable", 443, "GET / HTTP/1.0\r\n\r\n")

